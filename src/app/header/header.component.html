<ng-container *ngLet="user$ | async as user">
  <ng-container *ngLet="isMobile$ | async as isMobile">
    <bio-side-menu
      *ngIf="(sideMenuOpened$ | async) && user"
      [user]="user"
      [isMobile]="isMobile"
      (menuSelected)="toggleSideMenu($event)"
    ></bio-side-menu>
    <div class="brand-wrapper">
      <button bioButton icon type="button" (click)="toggleSideMenu($event)" *ngIf="user">
        <icon>menu</icon>
      </button>
      <a class="brand" routerLink="/"> Biomercs </a>
    </div>
    <div class="end">
      <ng-container *ngIf="isLogged$ | async; else notLogged">
        <a
          bioButton
          [icon]="isMobile"
          routerLink="/score/add"
          queryParamsHandling="preserve"
          tooltip="Submit score"
          tooltipPosition="bottom"
          [tooltipDisabled]="!isMobile"
        >
          <icon>add</icon>
          <ng-container *ngIf="!isMobile">Submit score</ng-container>
        </a>
        <button type="button" bioButton [menuTrigger]="menu">
          <icon>person</icon>
          {{ user.username }}
          <icon class="triangle" [mdi]="mdiTriangle" [size]="8"></icon>
        </button>
        <bio-menu #menu>
          <a bioButton menuItem [routerLink]="pathToProfile$ | async"> <icon>person</icon> Profile </a>
          <button type="button" bioButton menuItem (click)="logout()">
            <icon>logout</icon>
            Logout
          </button>
        </bio-menu>
      </ng-container>
      <ng-template #notLogged>
        <a bioButton routerLink="/auth/register">Register</a>
        <a bioButton routerLink="/auth/login">Login</a>
      </ng-template>
    </div>
  </ng-container>
</ng-container>
